# Задание 1.
Выполнить базовую настройку всех устройств:
a.Собрать топологию согласно рисунку. Все устройства работают на OC Linux - ALT
- ISP - Альт Сервер 10.2 (CLI)
- CLI - Альт Рабочая станция 10.2 (GUI)
- HQ-R - Альт Сервер 10.2 (CLI)
- HQ-SRV - Альт Сервер 10.2 (GUI)
- BR-R - Альт Сервер 10.2 (CLI)
- BR-SRV - Альт Сервер 10.2 (CLI)
b.Присвоить имена в соответствии с топологией
c.Рассчитать IP-адресацию IPv4 и IPv6. Необходимо заполнить таблицу №1. При необходимости отредактировать таблицу.
d.Пул адресов для сети офиса BRANCH - не более 16. Для IPv6 пропустить этот пункт.
e.Пул адресов для сети офиса HQ - не более 64. Для IPv6 пропустить этот пункт.
## Топология сети:
![image](https://github.com/Gogol15/demo2024/assets/79337104/f9e240bb-93ec-4c99-a504-37c2a01528f2)
## Таблица адресации:
| Имя устройства | Интерфейс |   IPv4/IPv6   | Маска/Префикс |      Шлюз      |
| -------------- | --------- | ------------- | ------------- | -------------- |
|                | ens192    | 10.12.26.13   | /30           | 10.12.26.254   |
| ISP            | ens224    | 192.168.0.166 | /30           |                |
|                | ens256    | 192.168.0.162 | /24           |                |
|                | ens161    | 192.168.0.170 | /30           |                |
| HQ-R           | ens192    | 192.168.0.2   | /25           |                |
|                | ens224    | 192.168.0.161 | /30           | 192.168.0.162  |
| BR-R           | ens192    | 192.168.0.130 | /27           |                |
|                | ens224    | 192.168.0.165 | /30           | 192.168.0.166  |
| HQ-SRV         | ens192    | 192.168.0.1   | /25           | 192.168.0.2    |
| BR-SRV         | ens192    | 192.168.0.129 | /27           | 192.168.0.130  |
| CLI            | ens192    | 192.168.0.169 | /30           | 192.168.0.170  |
## Настройка статической маршрутизации:
Для начала узнаем, какие папки интерфейсов отображаются на `ISP`
~~~
ls /etc/net/ifaces/
~~~
После того, как нам известны существующие интерфейсы, в случае недостающих, добавляем их:
~~~
mkdir /etc/net/ifaces/ensxxx
~~~
Далее с помощью службы `vim` или `nano` открываем файл `options` в папке с нашим интефейсом `(vim /etc/net/ifaces/ensxxx/options)` и в него вводим:
~~~
TYPE=eth
CONFIG_IPV4=yes
DISABLED=no
NM_CONTROLLED=no
~~~
Затем добавляем новый IP-адрес на интерфейс:
~~~
echo 192.168.0.170/30 > /etc/net/ifaces/ens192/ipv4address
~~~
В случае, если нужен шлюз, то пишмем:
~~~
echo default via xxx.xxx.xxx.xxx > /etc/net/ifaces/ensxxx/ipv4route
~~~
И перезагружаем сетевой сервис
~~~
systemctl restart network
~~~
Проверяем результат командой `ip a`

**Если на одном интерфейсе отображается 2 разных ip aдреса, то пишем команду:**
~~~
systemctl disable network.service NetworkManager
~~~
## Настройка туннеля на HQ-R и BR-R
Создаём директорию, ведущую к новому интерфейсу `tun1`
~~~
mkdir /etc/net/ifaces/tun1
~~~
Открываем файл `options` с использованием `vim` или `nano` (я пользуюсь vim)
~~~
vim /etc/net/ifaces/tun1/options
~~~
В нём указываем следующее:

![image](https://github.com/Gogol15/demo2024/assets/79337104/5790c202-103a-4648-a5db-a39851baa503)

**Где `TUNLOCAL` – ip адрес внешнего интефейса настраиваемой машины (HQ-R)**

**А `TUNREMOTE` – это ip адрес внешнего интерфейса второй машины (BR-R)**
## Настройка NAT на ISP, HQ-R, BR-R.
Для начала, на устройстве ISP установим сервис Firewalld:
~~~
apt-get install firewalld
~~~
Включаем автозагрузку^
~~~
systemctl enable --now firewalld
~~~
Добавляем правила к исходящим и входящим пакетам:
~~~
firewall-cmd --permanent --zone=public --add-interface=ens33
firewall-cmd --permanent --zone=trusted --add-interface=ens34
~~~
Включаем сам NAT:
~~~
firewall-cmd --permanent --zone=public --add-masquerade
~~~
И сохраняем правила:
~~~
firewall-cmd --reload
~~~
